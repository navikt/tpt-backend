package no.nav.tpt.domain.vulnerability

import kotlinx.serialization.Serializable
import java.time.Instant

@Serializable
data class VulnerabilitySearchRequest(
    val cveId: String? = null,
    val teamSlug: String? = null,
    val severity: List<String>? = null,
    val hasExternalIngress: Boolean? = null,
    val suppressed: Boolean? = null,
    val page: Int = 1,
    val pageSize: Int = 50
)

@Serializable
data class VulnerabilitySearchResponse(
    val items: List<VulnerabilitySearchItem>,
    val totalCount: Int,
    val page: Int,
    val pageSize: Int
)

@Serializable
data class VulnerabilitySearchItem(
    val cveId: String,
    val teamSlug: String,
    val applicationName: String,
    val applicationId: String,
    val workloadType: String,
    val environment: String?,
    val packageName: String?,
    val severity: String?,
    val hasExternalIngress: Boolean,
    val suppressed: Boolean,
    val discoveredAt: String,
    val lastSeenAt: String,
    val daysVulnerable: Long,
    val slaStatus: String
)

@Serializable
data class SlaOverdueResponse(
    val teams: List<TeamSlaStatus>,
    val totalOverdue: Int,
    val generatedAt: String
)

@Serializable
data class TeamSlaStatus(
    val teamSlug: String,
    val criticalOverdue: Int,
    val nonCriticalOverdue: Int,
    val criticalWithinSla: Int,
    val nonCriticalWithinSla: Int,
    val totalVulnerabilities: Int,
    val criticalOverdueItems: List<OverdueItem>? = null,
    val nonCriticalOverdueItems: List<OverdueItem>? = null
)

@Serializable
data class OverdueItem(
    val cveId: String,
    val applicationName: String,
    val severity: String?,
    val daysOverdue: Long,
    val workdaysOverdue: Int? = null
)
