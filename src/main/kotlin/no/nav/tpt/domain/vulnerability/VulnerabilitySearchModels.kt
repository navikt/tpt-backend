package no.nav.tpt.domain.vulnerability

import kotlinx.serialization.Serializable

@Serializable
data class SlaOverdueResponse(
    val teams: List<TeamSlaStatus>,
    val totalOverdue: Int,
    val generatedAt: String
)

@Serializable
data class TeamSlaStatus(
    val teamSlug: String,
    val criticalOverdue: Int,
    val nonCriticalOverdue: Int,
    val criticalWithinSla: Int,
    val nonCriticalWithinSla: Int,
    val totalVulnerabilities: Int,
    val repositoriesOutOfSla: Int,
    val maxDaysOverdue: Long,
    val criticalOverdueItems: List<OverdueItem>? = null,
    val nonCriticalOverdueItems: List<OverdueItem>? = null
)

@Serializable
data class OverdueItem(
    val cveId: String,
    val applicationName: String,
    val severity: String?,
    val daysOverdue: Long,
    val workdaysOverdue: Int? = null
)
