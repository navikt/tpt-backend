package no.nav.tpt.domain.risk.factors

import no.nav.tpt.domain.risk.FactorCalculator
import no.nav.tpt.domain.risk.RiskFactor
import no.nav.tpt.domain.risk.RiskScoringConfig
import no.nav.tpt.domain.risk.VulnerabilityRiskContext

class ExploitReferenceFactorCalculator(private val config: RiskScoringConfig) : FactorCalculator {

    override fun calculate(context: VulnerabilityRiskContext): RiskFactor {
        val multiplier = if (context.hasExploitReference) config.exploitReferenceMultiplier else 1.0

        return RiskFactor(
            name = "exploit_reference",
            value = multiplier,
            metadata = mapOf("hasExploit" to context.hasExploitReference)
        )
    }
}

