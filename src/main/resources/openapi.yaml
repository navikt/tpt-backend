openapi: 3.0.3
info:
  title: Titt-På-Ting Backend API
  description: API to help developers prioritize which security issues to fix first. Fetches vulnerability data from NAIS, enriches with CISA KEV catalog, and returns prioritized results.
  version: 0.0.1
  contact:
    name: Appsec
servers:
  - url: http://localhost:8080
    description: Local development server
paths:
  /isalive:
    get:
      summary: Liveness probe
      description: Returns liveness status of the application
      tags:
        - Health
      responses:
        '200':
          description: Application is alive
          content:
            text/plain:
              schema:
                type: string
                example: A-OK
  /isready:
    get:
      summary: Readiness probe
      description: Returns readiness status of the application
      tags:
        - Health
      responses:
        '200':
          description: Application is ready
          content:
            text/plain:
              schema:
                type: string
                example: KIROV REPORTING
  /config:
    get:
      summary: Get application configuration
      description: Returns configuration values for the frontend, including risk score thresholds for vulnerability bucketing
      tags:
        - Configuration
      responses:
        '200':
          description: Successfully retrieved configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigResponse'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /vulnerabilities/user:
    get:
      summary: Get vulnerabilities for authenticated user
      description: Fetches prioritized vulnerabilities for the authenticated user's teams and workloads
      tags:
        - Vulnerabilities
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully retrieved vulnerabilities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VulnResponse'
        '400':
          description: Bad request - preferred_username claim not found in token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Unauthorized - invalid or missing bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /vulnerabilities/github/user:
    get:
      summary: Get GitHub repository vulnerabilities for authenticated user
      description: Fetches prioritized GitHub repository vulnerabilities for the authenticated user's teams
      tags:
        - Vulnerabilities
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully retrieved GitHub repository vulnerabilities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GitHubVulnResponse'
        '400':
          description: Bad request - preferred_username claim not found in token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Unauthorized - invalid or missing bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /vulnerabilities/refresh:
    get:
      summary: Refresh vulnerability data for authenticated user's teams
      description: |
        Triggers a manual sync of vulnerability data from NAIS API for all teams the authenticated user belongs to.
        Updates the database with fresh vulnerability data. This endpoint is rate limited to 1 request per minute per user.
      tags:
        - Vulnerabilities
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully refreshed vulnerability data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VulnerabilityRefreshResponse'
        '400':
          description: Bad request - preferred_username claim not found in token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Unauthorized - invalid or missing bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '429':
          description: Too Many Requests - rate limit exceeded (1 request per minute)
          headers:
            Retry-After:
              schema:
                type: integer
              description: Number of seconds to wait before retrying
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /admin/status:
    get:
      summary: Admin status endpoint
      description: |
        Returns OK status if the authenticated user has admin privileges.
        This endpoint validates that the user's JWT token contains groups that match the configured admin groups.
      tags:
        - Admin
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User has admin privileges
          content:
            application/json:
              schema:
                type: object
                required:
                  - status
                properties:
                  status:
                    type: string
                    example: "OK"
        '401':
          description: Unauthorized - missing or invalid bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Forbidden - user does not have admin privileges
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /admin/teams/overview:
    get:
      summary: Get teams vulnerability overview
      description: |
        Returns an overview of vulnerabilities for all teams in the system.
        Shows total vulnerabilities and severity breakdown for each team.
        Only accessible to admin users.
      tags:
        - Admin
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully retrieved teams overview
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamsOverviewResponse'
        '401':
          description: Unauthorized - missing or invalid bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Forbidden - user does not have admin privileges
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /admin/teams/sla:
    get:
      summary: Get teams SLA report
      description: |
        Returns an SLA compliance report for all teams in the system.
        Shows overdue vulnerabilities and SLA status for each team.
        Critical vulnerabilities are overdue after 1 workday, others after 30 days.
        Only accessible to admin users.
      tags:
        - Admin
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully retrieved teams SLA report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamsSlaReportResponse'
        '401':
          description: Unauthorized - missing or invalid bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Forbidden - user does not have admin privileges
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /vulnerabilities/remediation:
    post:
      summary: Stream AI-generated remediation guide for a vulnerability
      description: |
        Streams an AI-generated remediation guide for the given CVE and workload context using Server-Sent Events (SSE).
        The guide is enriched with NVD description, CVSS score, CISA KEV status, and EPSS score.
        Results are cached in PostgreSQL by CVE ID and package ecosystem to avoid redundant AI calls.
        Requires `AI_API_URL` to be configured — returns 503 if the AI service is unavailable.
        Use `fetch()` with `response.body.getReader()` to consume the stream on the client side.
      tags:
        - Vulnerabilities
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RemediationRequest'
      responses:
        '200':
          description: SSE stream of remediation text chunks. Each `data:` event contains a text fragment. A final `event:done` signals completion. Errors are sent as `event:error`.
          content:
            text/event-stream:
              schema:
                type: string
              example: |
                data: ## Risk Summary

                data: This is a critical RCE vulnerability...

                event: done
                data:
        '400':
          description: Bad request - missing or invalid request body
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Unauthorized - invalid or missing bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '503':
          description: AI service not configured
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /sla/overdue:
    get:
      summary: Get SLA overdue report for user's teams
      description: Returns SLA compliance report for all teams the authenticated user belongs to, showing repository counts and max days overdue
      tags:
        - SLA
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully generated SLA report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SlaOverdueResponse'
        '400':
          description: Bad request - preferred_username claim not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Unauthorized - invalid or missing bearer token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '500':
          description: Internal server error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Bearer token authentication using JWT
  schemas:
    RemediationRequest:
      type: object
      required:
        - cveId
        - workloadName
        - environment
        - packageName
        - packageEcosystem
      properties:
        cveId:
          type: string
          example: CVE-2021-44228
        workloadName:
          type: string
          example: my-api
        environment:
          type: string
          example: production
        packageName:
          type: string
          example: log4j-core
        packageEcosystem:
          type: string
          example: MAVEN
    VulnResponse:
      type: object
      required:
        - userRole
        - teams
      properties:
        userRole:
          type: string
          enum: [ADMIN, DEVELOPER, TEAM_MEMBER, LEADER, NONE]
          description: |
            Role of the user requesting the data:
            - ADMIN: User is in an admin group (has elevated privileges)
            - DEVELOPER: User has direct NAIS team memberships
            - TEAM_MEMBER: User belongs to teams via Teamkatalogen but has no direct NAIS memberships
            - LEADER: User manages product areas with NAIS subteams
            - NONE: User has no team memberships in either system
          example: "DEVELOPER"
        teams:
          type: array
          items:
            $ref: '#/components/schemas/VulnTeamDto'
    VulnTeamDto:
      type: object
      required:
        - team
        - workloads
      properties:
        team:
          type: string
          description: Team name
        workloads:
          type: array
          items:
            $ref: '#/components/schemas/VulnWorkloadDto'
          description: Kubernetes workloads (NAIS applications and jobs) with their vulnerabilities
    VulnWorkloadDto:
      type: object
      required:
        - id
        - name
        - workloadType
        - vulnerabilities
      properties:
        id:
          type: string
          description: Unique workload identifier
        name:
          type: string
          description: Workload name
        workloadType:
          type: string
          description: Type of workload - either "app" for NAIS applications or "job" for NAIS jobs
          enum: [app, job]
          example: "app"
        environment:
          type: string
          nullable: true
          description: Deployment environment name (e.g., prod-gcp, dev-gcp)
          example: "prod-gcp"
        repository:
          type: string
          nullable: true
          description: GitHub repository name (e.g., navikt/app-name)
          example: "navikt/my-application"
        lastDeploy:
          type: string
          nullable: true
          description: Last deployment timestamp in ISO 8601 format
          example: "2026-01-12T11:26:21.02093Z"
        vulnerabilities:
          type: array
          items:
            $ref: '#/components/schemas/VulnVulnerabilityDto'
    VulnVulnerabilityDto:
      type: object
      required:
        - identifier
        - riskScore
      properties:
        identifier:
          type: string
          description: Vulnerability identifier (e.g., CVE-2024-1234)
          example: "CVE-2024-1234"
        name:
          type: string
          nullable: true
          description: Package name extracted from PURL identifier or GitHub package name
          example: "log4j-core"
        packageName:
          type: string
          nullable: true
          description: Package name affected by the vulnerability (PURL format from Nais API or GitHub package name)
          example: "pkg:maven/org.apache.logging.log4j/log4j-core@2.14.1"
        description:
          type: string
          nullable: true
          description: Human-readable description of the vulnerability
          example: "A buffer overflow vulnerability in the X.509 certificate parser could allow remote code execution"
        vulnerabilityDetailsLink:
          type: string
          nullable: true
          description: URL to detailed information about the vulnerability
          example: "https://nvd.nist.gov/vuln/detail/CVE-2024-1234"
        riskScore:
          type: number
          format: double
          description: Calculated risk score using multiplier-based system. Base severity score multiplied by exposure (ingress type), KEV presence, EPSS probability, suppression status, environment, and build age. Higher scores indicate higher priority vulnerabilities.
          example: 300.0
        riskScoreBreakdown:
          allOf:
            - $ref: '#/components/schemas/RiskScoreBreakdown'
          nullable: true
          description: Detailed breakdown of how the risk score was calculated
        dependencyScope:
          type: string
          nullable: true
          description: Scope of the dependency (RUNTIME, DEVELOPMENT, etc.) - GitHub vulnerabilities only
          example: "RUNTIME"
        dependabotUpdatePullRequestUrl:
          type: string
          nullable: true
          description: URL to the Dependabot pull request that updates this dependency - GitHub vulnerabilities only
          example: "https://github.com/org/repo/pull/42"
        publishedAt:
          type: string
          nullable: true
          description: ISO 8601 timestamp when the vulnerability was published - GitHub vulnerabilities only
          example: "2024-01-15T10:30:00Z"
        cvssScore:
          type: number
          format: double
          nullable: true
          description: CVSS score for the vulnerability - GitHub vulnerabilities only
          example: 9.8
        summary:
          type: string
          nullable: true
          description: Short summary of the vulnerability - GitHub vulnerabilities only
          example: "Critical vulnerability in dependency"
        packageEcosystem:
          type: string
          nullable: true
          description: Package ecosystem (NPM, MAVEN, PIP, etc.) - GitHub vulnerabilities only
          example: "NPM"
    RiskScoreBreakdown:
      type: object
      required:
        - baseScore
        - factors
        - totalScore
      properties:
        baseScore:
          type: number
          format: double
          description: Base severity score before multipliers
          example: 70.0
        factors:
          type: array
          items:
            $ref: '#/components/schemas/RiskFactorExplanation'
          description: List of factors that contributed to the risk score, including the base severity score as a factor.
        totalScore:
          type: number
          format: double
          description: Final calculated risk score
          example: 184.8
    RiskFactorExplanation:
      type: object
      required:
        - name
        - contribution
        - explanation
        - impact
        - multiplier
      properties:
        name:
          type: string
          description: Factor name (e.g., severity, exposure, kev, epss). The severity factor represents the base score.
          example: "kev"
        contribution:
          type: number
          format: double
          description: Numeric contribution of this factor to the total score
          example: 140.0
        explanation:
          type: string
          description: Human-readable explanation of the factor
          example: "Listed in CISA KEV catalog"
        impact:
          type: string
          enum: [CRITICAL, HIGH, MEDIUM, LOW, NONE]
          description: Impact level of this factor
          example: "CRITICAL"
        multiplier:
          type: number
          format: double
          description: The multiplier value applied for this factor. Values >1.0 increase risk, <1.0 decrease risk, =1.0 no effect (base severity).
          example: 2.0
    ProblemDetail:
      type: object
      required:
        - type
        - title
        - status
      properties:
        type:
          type: string
          description: A URI reference that identifies the problem type
          example: about:blank
        title:
          type: string
          description: A short, human-readable summary of the problem type
          example: Bad Request
        status:
          type: integer
          description: The HTTP status code
          example: 400
        detail:
          type: string
          nullable: true
          description: A human-readable explanation specific to this occurrence of the problem
        instance:
          type: string
          nullable: true
          description: A URI reference that identifies the specific occurrence of the problem
    ConfigResponse:
      type: object
      required:
        - thresholds
        - aiEnabled
      properties:
        thresholds:
          $ref: '#/components/schemas/RiskThresholds'
        aiEnabled:
          type: boolean
          description: Indicates whether AI-based remediation generation is configured and available
    RiskThresholds:
      type: object
      required:
        - high
        - medium
        - low
      properties:
        high:
          type: number
          format: double
          description: Risk score threshold for high-priority vulnerabilities. Scores >= this value should be treated as high priority
          example: 150.0
        medium:
          type: number
          format: double
          description: Risk score threshold for medium-priority vulnerabilities. Scores >= this value and < high should be treated as medium priority
          example: 75.0
        low:
          type: number
          format: double
          description: Risk score threshold for low-priority vulnerabilities. Scores >= this value and < medium should be treated as low priority
          example: 30.0
    GitHubVulnResponse:
      type: object
      required:
        - userRole
        - teams
      properties:
        userRole:
          type: string
          enum: [ADMIN, DEVELOPER, TEAM_MEMBER, LEADER, NONE]
          description: |
            Role of the user requesting the data:
            - ADMIN: User is in an admin group (has elevated privileges)
            - DEVELOPER: User has direct NAIS team memberships
            - TEAM_MEMBER: User belongs to teams via Teamkatalogen but has no direct NAIS memberships
            - LEADER: User manages product areas with NAIS subteams
            - NONE: User has no team memberships in either system
          example: "DEVELOPER"
        teams:
          type: array
          items:
            $ref: '#/components/schemas/GitHubVulnTeamDto'
    GitHubVulnTeamDto:
      type: object
      required:
        - team
        - repositories
      properties:
        team:
          type: string
          description: Team name
          example: "appsec"
        repositories:
          type: array
          items:
            $ref: '#/components/schemas/GitHubVulnRepositoryDto'
          description: GitHub repositories with their vulnerabilities
    GitHubVulnRepositoryDto:
      type: object
      required:
        - nameWithOwner
        - vulnerabilities
      properties:
        nameWithOwner:
          type: string
          description: GitHub repository name with owner (e.g., navikt/my-repo)
          example: "navikt/tpt-backend"
        usesDistroless:
          type: boolean
          nullable: true
          description: Whether the repository uses distroless Docker images
          example: true
        vulnerabilities:
          type: array
          items:
            $ref: '#/components/schemas/GitHubVulnVulnerabilityDto'
          description: Vulnerabilities found in the GitHub repository
    GitHubVulnVulnerabilityDto:
      type: object
      required:
        - identifier
        - riskScore
      properties:
        identifier:
          type: string
          description: CVE identifier
          example: "CVE-2024-1234"
        packageName:
          type: string
          nullable: true
          description: Name of the affected package
          example: "lodash"
        packageEcosystem:
          type: string
          nullable: true
          description: Package ecosystem (NPM, MAVEN, PIP, etc.)
          example: "NPM"
        description:
          type: string
          nullable: true
          description: Human-readable description of the vulnerability
          example: "Prototype pollution vulnerability allowing remote code execution"
        summary:
          type: string
          nullable: true
          description: Short summary of the vulnerability
          example: "Prototype pollution in lodash"
        vulnerabilityDetailsLink:
          type: string
          nullable: true
          description: URL to detailed information about the vulnerability
          example: "https://nvd.nist.gov/vuln/detail/CVE-2024-1234"
        riskScore:
          type: number
          format: double
          description: Calculated risk score. Higher scores indicate higher priority vulnerabilities.
          example: 140.0
        riskScoreBreakdown:
          allOf:
            - $ref: '#/components/schemas/RiskScoreBreakdown'
          nullable: true
          description: Detailed breakdown of how the risk score was calculated
        dependencyScope:
          type: string
          nullable: true
          description: Scope of the dependency (RUNTIME, DEVELOPMENT, etc.)
          example: "RUNTIME"
        dependabotUpdatePullRequestUrl:
          type: string
          nullable: true
          description: URL to the Dependabot pull request that updates this dependency
          example: "https://github.com/navikt/tpt-backend/pull/123"
        publishedAt:
          type: string
          nullable: true
          description: ISO 8601 timestamp when the vulnerability was published
          example: "2024-01-15T10:30:00Z"
        cvssScore:
          type: number
          format: double
          nullable: true
          description: CVSS score for the vulnerability
          example: 7.0
    SlaOverdueResponse:
      type: object
      required:
        - teams
        - totalOverdue
        - generatedAt
      properties:
        teams:
          type: array
          items:
            $ref: '#/components/schemas/TeamSlaStatus'
          description: SLA status per team
        totalOverdue:
          type: integer
          description: Total number of overdue vulnerabilities across all teams
          example: 57
        generatedAt:
          type: string
          description: ISO 8601 timestamp when report was generated
          example: "2024-01-15T10:30:00Z"
    TeamSlaStatus:
      type: object
      required:
        - teamSlug
        - criticalOverdue
        - nonCriticalOverdue
        - criticalWithinSla
        - nonCriticalWithinSla
        - totalVulnerabilities
        - repositoriesOutOfSla
        - maxDaysOverdue
      properties:
        teamSlug:
          type: string
          description: Team identifier
          example: "team-a"
        criticalOverdue:
          type: integer
          description: Number of critical vulnerabilities overdue (>1 workday)
          example: 3
        nonCriticalOverdue:
          type: integer
          description: Number of non-critical vulnerabilities overdue (>30 days)
          example: 12
        criticalWithinSla:
          type: integer
          description: Number of critical vulnerabilities within SLA
          example: 5
        nonCriticalWithinSla:
          type: integer
          description: Number of non-critical vulnerabilities within SLA
          example: 18
        totalVulnerabilities:
          type: integer
          description: Total number of active vulnerabilities for this team
          example: 38
        repositoriesOutOfSla:
          type: integer
          description: Number of repositories with at least one overdue vulnerability
          example: 5
        maxDaysOverdue:
          type: integer
          format: int64
          description: Maximum number of days any vulnerability is overdue in this team
          example: 45
        criticalOverdueItems:
          type: array
          items:
            $ref: '#/components/schemas/OverdueItem'
          description: Optional list of critical vulnerabilities that are overdue
        nonCriticalOverdueItems:
          type: array
          items:
            $ref: '#/components/schemas/OverdueItem'
          description: Optional list of non-critical vulnerabilities that are overdue
    OverdueItem:
      type: object
      required:
        - cveId
        - applicationName
        - severity
        - daysOverdue
      properties:
        cveId:
          type: string
          description: CVE identifier
          example: "CVE-2024-1234"
        applicationName:
          type: string
          description: Application or job name
          example: "my-application"
        severity:
          type: string
          description: Vulnerability severity
          example: "CRITICAL"
        daysOverdue:
          type: integer
          format: int64
          description: Number of days overdue
          example: 5
        workdaysOverdue:
          type: integer
          description: Number of workdays overdue (only for critical vulnerabilities)
          example: 3


    VulnerabilityRefreshResponse:
      type: object
      required:
        - message
        - results
      properties:
        message:
          type: string
          description: Summary message of the refresh operation
          example: "Successfully refreshed vulnerability data"
        results:
          type: array
          items:
            $ref: '#/components/schemas/TeamSyncResult'
          description: Sync results per team
    TeamSyncResult:
      type: object
      required:
        - teamSlug
        - processed
        - inserted
        - skipped
      properties:
        teamSlug:
          type: string
          description: Team identifier
          example: "team-a"
        processed:
          type: integer
          description: Total number of vulnerabilities processed
          example: 150
        inserted:
          type: integer
          description: Number of vulnerabilities inserted/updated in database
          example: 145
        skipped:
          type: integer
          description: Number of vulnerabilities skipped due to validation errors
          example: 5
    
    TeamsOverviewResponse:
      type: object
      required:
        - teams
        - totalTeams
        - totalVulnerabilities
        - generatedAt
      properties:
        teams:
          type: array
          items:
            $ref: '#/components/schemas/TeamOverview'
          description: List of teams with their vulnerability counts
        totalTeams:
          type: integer
          description: Total number of teams with vulnerabilities
          example: 42
        totalVulnerabilities:
          type: integer
          description: Total number of vulnerabilities across all teams
          example: 1523
        generatedAt:
          type: string
          description: ISO 8601 timestamp when the report was generated
          example: "2024-01-15T10:30:00Z"
    
    TeamOverview:
      type: object
      required:
        - teamSlug
        - totalVulnerabilities
        - criticalVulnerabilities
        - highVulnerabilities
        - mediumVulnerabilities
        - lowVulnerabilities
        - unknownVulnerabilities
      properties:
        teamSlug:
          type: string
          description: Team identifier
          example: "team-security"
        totalVulnerabilities:
          type: integer
          description: Total number of vulnerabilities for this team
          example: 87
        criticalVulnerabilities:
          type: integer
          description: Number of critical severity vulnerabilities
          example: 5
        highVulnerabilities:
          type: integer
          description: Number of high severity vulnerabilities
          example: 12
        mediumVulnerabilities:
          type: integer
          description: Number of medium severity vulnerabilities
          example: 35
        lowVulnerabilities:
          type: integer
          description: Number of low severity vulnerabilities
          example: 30
        unknownVulnerabilities:
          type: integer
          description: Number of vulnerabilities with unknown severity
          example: 5
    
    TeamsSlaReportResponse:
      type: object
      required:
        - teams
        - totalTeams
        - totalOverdue
        - totalCriticalOverdue
        - totalNonCriticalOverdue
        - generatedAt
      properties:
        teams:
          type: array
          items:
            $ref: '#/components/schemas/TeamSlaOverview'
          description: SLA status for each team
        totalTeams:
          type: integer
          description: Total number of teams with vulnerabilities
          example: 42
        totalOverdue:
          type: integer
          description: Total number of overdue vulnerabilities across all teams
          example: 234
        totalCriticalOverdue:
          type: integer
          description: Total number of overdue critical vulnerabilities across all teams
          example: 45
        totalNonCriticalOverdue:
          type: integer
          description: Total number of overdue non-critical vulnerabilities across all teams
          example: 189
        generatedAt:
          type: string
          description: ISO 8601 timestamp when the report was generated
          example: "2024-01-15T10:30:00Z"
    
    TeamSlaOverview:
      type: object
      required:
        - teamSlug
        - totalVulnerabilities
        - criticalOverdue
        - nonCriticalOverdue
        - criticalWithinSla
        - nonCriticalWithinSla
        - repositoriesOutOfSla
        - maxDaysOverdue
      properties:
        teamSlug:
          type: string
          description: Team identifier
          example: "team-security"
        totalVulnerabilities:
          type: integer
          description: Total number of vulnerabilities for this team
          example: 87
        criticalOverdue:
          type: integer
          description: Number of critical vulnerabilities overdue (>1 workday)
          example: 3
        nonCriticalOverdue:
          type: integer
          description: Number of non-critical vulnerabilities overdue (>30 days)
          example: 12
        criticalWithinSla:
          type: integer
          description: Number of critical vulnerabilities within SLA
          example: 7
        nonCriticalWithinSla:
          type: integer
          description: Number of non-critical vulnerabilities within SLA
          example: 65
        repositoriesOutOfSla:
          type: integer
          description: Number of repositories with at least one overdue vulnerability
          example: 4
        maxDaysOverdue:
          type: integer
          format: int64
          description: Maximum number of days any vulnerability is overdue in this team
          example: 45

