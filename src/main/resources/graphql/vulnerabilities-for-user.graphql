query VulnerabilitiesForUser($email: String!, $teamFirst: Int = 2, $teamAfter: Cursor, $workloadFirst: Int = 50, $workloadAfter: Cursor, $vulnFirst: Int = 50, $vulnAfter: Cursor) {
  user(email: $email) {
    teams(first: $teamFirst, after: $teamAfter) {
      pageInfo {
        hasNextPage
        endCursor
      }
      nodes {
        team {
          slug
          workloads(first: $workloadFirst, after: $workloadAfter) {
            pageInfo {
              hasNextPage
              endCursor
            }
            nodes {
              id
              name
              deployments(first: 1) {
                nodes {
                  repository
                }
              }
              image {
                name
                tag
                vulnerabilities(first: $vulnFirst, after: $vulnAfter) {
                  pageInfo {
                    hasNextPage
                    endCursor
                  }
                  nodes {
                    identifier
                    description
                    vulnerabilityDetailsLink
                    severity
                    package
                    suppression {
                      state
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}