query VulnerabilitiesForUser($email: String!, $workloadFirst: Int = 50, $workloadAfter: Cursor, $vulnFirst: Int = 50, $vulnAfter: Cursor) {
  user(email: $email) {
    teams {
      nodes {
        team {
          slug
          workloads(first: $workloadFirst, after: $workloadAfter) {
            pageInfo {
              hasNextPage
              endCursor
            }
            nodes {
              id
              name
              deployments(first: 1) {
                nodes {
                  repository
                }
              }
              image {
                name
                tag
                vulnerabilities(first: $vulnFirst, after: $vulnAfter) {
                  pageInfo {
                    hasNextPage
                    endCursor
                  }
                  nodes {
                    identifier
                    severity
                    package
                    suppression {
                      state
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}