-- Add additional fields to github_vulnerabilities table
-- These fields come from GitHub Dependabot API and provide more context about vulnerabilities

ALTER TABLE github_vulnerabilities
    ADD COLUMN dependency_scope VARCHAR(50),
    ADD COLUMN dependabot_update_pull_request_url TEXT,
    ADD COLUMN published_at TIMESTAMP,
    ADD COLUMN cvss_score DECIMAL(3, 1),
    ADD COLUMN summary TEXT,
    ADD COLUMN package_ecosystem VARCHAR(50),
    ADD COLUMN package_name VARCHAR(500);

-- Index for querying by package ecosystem
CREATE INDEX idx_github_vulns_package_ecosystem ON github_vulnerabilities(package_ecosystem);

-- Index for querying by published_at for sorting/filtering
CREATE INDEX idx_github_vulns_published_at ON github_vulnerabilities(published_at);

-- Index for querying by CVSS score for sorting/filtering
CREATE INDEX idx_github_vulns_cvss_score ON github_vulnerabilities(cvss_score);
